#!/bin/bash

bold_white='\[\e[1;37m\]'
bold_green='\[\e[1;32m\]'
bold_yellow='\[\e[1;33m\]'
bold_cyan='\[\e[1;36m\]'
cyan='\[\e[0;36m\]'

punc_color=$bold_white
user_host_color='\[$([[ "\$" == "#" ]] && echo "\e[1;91m" || echo "\e[0;32m")\]'
path_color=$cyan
exit_string='\[$([[ $? -eq 0 ]] && echo "\e[0;32m(0)\e[0m" || echo "\e[41m\e[1;37m($?)\e[40m\e[0m")\]'
hist_color=$bold_cyan
prompt_color=$punc_color
input_color=$bold_yellow
path_string='\[$(_PS1 "$PWD" 40)\]'

# Bash shortener
_PS1 ()
{
    local PRE= NAME="$1" LENGTH="$2";
    [[ "$NAME" != "${NAME#$HOME/}" || -z "${NAME#$HOME}" ]] &&
        PRE+='~' NAME="${NAME#$HOME}" LENGTH=$[LENGTH-1];
    ((${#NAME}>$LENGTH)) && NAME="/...${NAME:$[${#NAME}-LENGTH+4]}";
    echo "$PRE$NAME"
}

export PS1="${punc_color}[${user_host_color}\\u@\\h${punc_color}:${path_color}${path_string}${punc_color}] ${exit_string}\\n${hist_color}\\!${prompt_color}\\$ ${input_color}"
if [ $(uname) == 'Darwin' ]; then
  trap "echo -n $'\e[0m'" DEBUG
else
  trap 'echo -ne "\e[0m"' DEBUG
fi
